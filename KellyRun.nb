(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32289,        827]
NotebookOptionsPosition[     31211,        787]
NotebookOutlinePosition[     31548,        802]
CellTagsIndexPosition[     31505,        799]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"silver", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Date\>\"", "\[Rule]", "#1"}], ",", 
        RowBox[{"\"\<Value\>\"", "\[Rule]", "#2"}]}], "|>"}], "&"}], "@@@", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<quote-download/XAG.csv\>\"", ",", " ", "\"\<Table\>\""}], 
      "]"}]}], "//", "Rest"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"decisionsRawWithSchema", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<ag-lm-1.csv\>\"", ",", " ", "\"\<Data\>\""}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dates", "=", 
         RowBox[{"First", "/@", "silver"}]}], ",", " ", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "@", "silver"}]}]}], "}"}], ",", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"dates", ",", "  ", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", " ", "n"}], "]"}], 
         ",", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.25", ",", "10"}], "}"}], ",", " ", "n"}], "]"}]}], 
        "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"First", "/@", "silver"}], " ", "\[Equal]", 
     RowBox[{"First", "/@", "decisions"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binaryDecisionsRawWithSchema", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<lasso-binary-ag-1.csv\>\"", ",", " ", "\"\<Data\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656805642516829*^9, 3.6568057271775713`*^9}, {
  3.656806521973482*^9, 3.656806537057242*^9}, {3.656806576866538*^9, 
  3.656806606162609*^9}, {3.6568066495233994`*^9, 3.656806703566689*^9}, {
  3.656806742598598*^9, 3.6568067824219933`*^9}, {3.656806838855907*^9, 
  3.656806854613645*^9}, {3.656806884705585*^9, 3.6568068934078407`*^9}, {
  3.656810411601328*^9, 3.656810428320326*^9}, {3.65728319133917*^9, 
  3.657283202635228*^9}, {3.6572833526467333`*^9, 3.657283357173815*^9}, {
  3.6572850107224827`*^9, 3.6572850110657988`*^9}, {3.6572857076398973`*^9, 
  3.657285709079067*^9}, {3.657286349397767*^9, 3.6572863843729877`*^9}, {
  3.6578075896846657`*^9, 3.657807589916909*^9}, {3.657807632048141*^9, 
  3.657807655950284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"decisionsRawWithSchema", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.657285715133581*^9, 3.6572857175517263`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", "\<\"as.Date(dates[783:804])\"\>", 
   ",", "\<\"ex/100\"\>", ",", "\<\"upper/100\"\>", ",", "\<\"lower/100\"\>", 
   ",", "\<\"actuals/100\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.657285717898303*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"binaryDecisionsRawWithSchema", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6578077880739822`*^9, 3.657807789926181*^9}, {
  3.657807835157434*^9, 3.657807836884766*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", "\<\"dates.585.805.\"\>", 
   ",", "\<\"as.vector.pr.\"\>", ",", "\<\"as.vector.pred...1..\"\>", 
   ",", "\<\"as.vector.pred...2..\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.657807790219996*^9, {3.6578078355927362`*^9, 3.657807837076211*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"decisionsRaw", "=", 
   RowBox[{"Rest", "@", "decisionsRawWithSchema"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binaryRaw", "=", 
   RowBox[{"Rest", "@", "binaryDecisionsRawWithSchema"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logNormalVar", "[", 
    RowBox[{"mu_", ",", "var_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Exp", "[", "var", "]"}], "-", "1"}], ")"}], 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"2", "mu"}], "+", "var"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decisions", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dates", "=", 
        RowBox[{"decisionsRaw", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"meanLogReturns", "=", 
        RowBox[{"decisionsRaw", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", 
       RowBox[{"varLogReturns", "=", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"decisionsRaw", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "4"}], "]"}], "]"}], "-", 
            RowBox[{"decisionsRaw", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "5"}], "]"}], "]"}]}], 
           RowBox[{"2", "*", "2", " ", 
            RowBox[{"(*", 
             RowBox[{"95", "%", " ", "ci"}], "*)"}]}]], ")"}], "2"]}]}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Date\>\"", "\[Rule]", "#1"}], ",", 
         RowBox[{"\"\<Return\>\"", "\[Rule]", "#2"}], ",", 
         RowBox[{"\"\<Var\>\"", "\[Rule]", "#3"}]}], "|>"}], "&"}], "@@@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"dates", ",", 
         RowBox[{
          RowBox[{"Exp", "[", "meanLogReturns", "]"}], "-", "1"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"logNormalVar", ",", 
           RowBox[{"{", 
            RowBox[{"meanLogReturns", ",", "varLogReturns"}], "}"}]}], 
          "]"}]}], "}"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binary", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Date\>\"", "\[Rule]", "#1"}], ",", 
       RowBox[{"\"\<Buy\>\"", "\[Rule]", "#2"}]}], "|>"}], "&"}], "@@@", 
    "binaryRaw"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.65728501380488*^9, 3.6572850369656878`*^9}, {
   3.657285102040361*^9, 3.657285118423678*^9}, {3.6572853734224997`*^9, 
   3.657285466216805*^9}, {3.657285522838579*^9, 3.657285762010478*^9}, {
   3.657285906851521*^9, 3.657285950487563*^9}, {3.657285982415751*^9, 
   3.6572859882791977`*^9}, {3.657286426194031*^9, 3.6572864720733023`*^9}, {
   3.657286926237834*^9, 3.657286954576515*^9}, {3.657287521908414*^9, 
   3.657287522183867*^9}, {3.657291505963832*^9, 3.657291556503409*^9}, {
   3.65729160087525*^9, 3.65729160411765*^9}, 3.657291678521524*^9, {
   3.657291733895733*^9, 3.6572917351856947`*^9}, 3.657296097146632*^9, {
   3.6578077928933372`*^9, 3.657807866430084*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"joined", "=", 
   RowBox[{"JoinAcross", "[", 
    RowBox[{"decisions", ",", " ", "silver", ",", 
     RowBox[{"Key", "[", "\"\<Date\>\"", "]"}], ",", "\"\<Left\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"joinedBin", "=", 
   RowBox[{"JoinAcross", "[", 
    RowBox[{"binary", ",", " ", "silver", ",", 
     RowBox[{"Key", "[", "\"\<Date\>\"", "]"}], ",", "\"\<Left\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.657286487160692*^9, 3.6572865296268997`*^9}, {
  3.65780788610122*^9, 3.6578078943907547`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Length", "@", "joined"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "joinedBin"}]}], "Input",
 CellChangeTimes->{{3.65729601514282*^9, 3.657296017186095*^9}, {
  3.657807895537224*^9, 3.6578078984810038`*^9}}],

Cell[BoxData["22"], "Output",
 CellChangeTimes->{
  3.6572960254328003`*^9, {3.657807898791162*^9, 3.657807901673956*^9}}],

Cell[BoxData["221"], "Output",
 CellChangeTimes->{
  3.6572960254328003`*^9, {3.657807898791162*^9, 3.65780790167441*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"invest", "=", "1000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeInvestment", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"money_", ",", "ownedCommodities_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"leverage_", ",", " ", "currPrice_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toSell", "=", 
      RowBox[{"ownedCommodities", "*", "currPrice"}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newMoney", "=", 
        RowBox[{"money", "+", "toSell"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"toSpend", "=", 
          RowBox[{"newMoney", "*", "leverage"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newCommodities", "=", 
            RowBox[{"toSpend", "/", "currPrice"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"newMoney", "-", "toSpend"}], ",", " ", 
            "newCommodities"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{"FoldList", "[", 
    RowBox[{"makeInvestment", ",", " ", 
     RowBox[{"{", 
      RowBox[{"invest", ",", "0"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Return\>\"", "]"}], "/", 
          RowBox[{"#", "[", "\"\<Var\>\"", "]"}]}], ",", 
         RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "}"}], "&"}], "/@", 
      "joined"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prices", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", "joined"}], ",", 
     RowBox[{
      RowBox[{"First", "[", "joined", "]"}], "[", "\"\<Value\>\"", "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"value", "=", 
   RowBox[{
    RowBox[{"First", "/@", "state"}], "+", 
    RowBox[{
     RowBox[{"Last", "/@", "state"}], "*", "prices"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656806797742342*^9, 3.65680680551661*^9}, {
   3.6568068667634478`*^9, 3.6568068961836557`*^9}, 3.6568071118479033`*^9, 
   3.6568080085873404`*^9, {3.656808042121334*^9, 3.656808047353702*^9}, {
   3.656808078737555*^9, 3.656808160610395*^9}, {3.6568081943420143`*^9, 
   3.6568083266105947`*^9}, {3.656808374146112*^9, 3.6568084577507133`*^9}, {
   3.656808572060007*^9, 3.656808576116631*^9}, {3.656808619870462*^9, 
   3.656808620876823*^9}, {3.656808652067164*^9, 3.656808656687986*^9}, {
   3.656808925788609*^9, 3.6568090161727057`*^9}, {3.6568090852326317`*^9, 
   3.656809114604982*^9}, {3.657286589125533*^9, 3.657286592415312*^9}, {
   3.6572866359891644`*^9, 3.657286670002015*^9}, {3.6572867972979307`*^9, 
   3.657286815766407*^9}, {3.657286857393908*^9, 3.657286884211424*^9}, {
   3.657287010580776*^9, 3.6572870156844397`*^9}, {3.657296132991131*^9, 
   3.65729614235765*^9}, {3.657808097506473*^9, 3.657808100375308*^9}, {
   3.657808141309396*^9, 3.6578081415225153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"boolSgn", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{"x", ",", " ", "1", ",", " ", 
    RowBox[{"-", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6578085546732407`*^9, 3.657808568099963*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"makeInvestmentBinAvg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "money_", ",", "ownedCommodities_", ",", "oldEdge_", ",", "n_", ",", 
      "lastPrice_", ",", "lastBet_"}], 
     RowBox[{"(*", 
      RowBox[{"direction", ",", " ", 
       RowBox[{"via", " ", "sign"}], ",", " ", 
       RowBox[{"of", " ", "last", " ", "bet"}], ",", " ", 
       RowBox[{"1", " ", "=", " ", "buy"}], ",", " ", 
       RowBox[{
        RowBox[{"-", "1"}], " ", "=", " ", "short"}]}], "*)"}], "}"}], ",", 
    "currPrice_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"runningEdge", "=", 
       FractionBox[
        RowBox[{
         RowBox[{"oldEdge", " ", "*", "n"}], "+", 
         RowBox[{"lastBet", "*", 
          RowBox[{"boolSgn", "[", 
           RowBox[{"lastPrice", "<", "currPrice"}], "]"}]}]}], 
        RowBox[{"n", "+", "1"}]]}], ",", 
      RowBox[{"toSell", "=", 
       RowBox[{"ownedCommodities", "*", "currPrice"}]}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newMoney", "=", 
        RowBox[{"money", "+", "toSell"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"toSpend", "=", 
          RowBox[{"newMoney", "*", "runningEdge"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"assume", " ", "1"}], ":", 
           RowBox[{"1", " ", "odds"}]}], "*)"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newCommodities", "=", 
            RowBox[{"toSpend", "/", "currPrice"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"newMoney", "-", "toSpend"}], ",", " ", "newCommodities", 
            ",", "runningEdge", ",", 
            RowBox[{"n", "+", "1"}], ",", "currPrice", ",", 
            RowBox[{"boolSgn", "[", 
             RowBox[{"toSpend", ">", "0"}], "]"}]}], "}"}]}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateBin", "=", 
   RowBox[{"FoldList", "[", 
    RowBox[{"makeInvestmentBinAvg", ",", 
     RowBox[{"{", 
      RowBox[{
      "invest", ",", " ", "0", ",", " ", "0.5", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", "joinedBin"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pricesBin", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", "joined"}], ",", 
     RowBox[{
      RowBox[{"First", "[", "joined", "]"}], "[", "\"\<Value\>\"", "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valueBin", "=", 
   RowBox[{
    RowBox[{"First", "/@", "state"}], "+", 
    RowBox[{
     RowBox[{"Last", "/@", "state"}], "*", "prices"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.657807931712964*^9, 3.657808026232649*^9}, {
  3.657808148417593*^9, 3.6578081541821537`*^9}, {3.6578082495799932`*^9, 
  3.6578082623643293`*^9}, {3.657808312300622*^9, 3.657808316206072*^9}, {
  3.657808389862636*^9, 3.657808681573633*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Labeled", "[", 
  RowBox[{
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"TwoAxisListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prices", ",", "value"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time\>\"", ",", "\"\<Silver Price\>\""}], 
               "}"}]}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time\>\"", ",", " ", "\"\<Net Value\>\""}], 
               "}"}]}]}], "}"}]}], "}"}]}], "]"}], ",", "\"\<Ag Price\>\"", 
       ",", " ", "Left"}], "]"}], ",", "\"\<Net Value\>\"", ",", " ", 
     "Right"}], "]"}], ",", "\"\<Time\>\"", ",", " ", "Bottom"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.656807638897766*^9, 3.6568076451392107`*^9}, {
  3.656809125796892*^9, 3.656809137882715*^9}, {3.656809229337903*^9, 
  3.656809269281384*^9}, {3.656809321288967*^9, 3.6568094630059023`*^9}, {
  3.656809621205243*^9, 3.6568097079679127`*^9}, {3.6568097724792137`*^9, 
  3.656809774772797*^9}, {3.657286912181917*^9, 3.6572869127733297`*^9}, {
  3.657287021900613*^9, 3.657287052401288*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{
     TemplateBox[{
       GraphicsBox[{{{}, {{{}, {}, {
             Hue[0.67, 0.6, 0.6], 
             Directive[
              PointSize[0.012833333333333334`], 
              AbsoluteThickness[1.6], 
              RGBColor[0.24720000000000014`, 0.24, 0.6]], 
             LineBox[CompressedData["
1:eJxTTMoPSmViYGAQB2IQDQEf7HVSJR9FhOs5QAUcUPkcDhr83FuXRcL4Ag6l
TLM4pONgfBEHqQPRCo6CML6EwysWE0GzObpQvoxDzacNAdm3YHwFB/27KmyN
pjD1Sg4JTy8o3baE8VUczDsdE55ugKlXc5hjvGiLuQWMrwHVD+NrOVhuOVG2
rx7G13EQlT351L4FZp6eQ/K7KCe7EzC+gcPEtzX2pnX6UL6hA5/uprnvn8P4
Rg5x3ifYbathfGMH//VTUjsWw/gmDstmH1HYsAnGN3XYwPy8R+MsjG/mcGSj
Xt7ihTC+ucOBN/NsdFgMHAC6F1Lg
              "]]}}}, {}}, 
         GeometricTransformationBox[{{}, {{{}, {}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[0.012833333333333334`], 
               AbsoluteThickness[1.6], 
               RGBColor[0.6, 0.24, 0.4428931686004542]], 
              
              LineBox[{{1., 1.*^6}, {2., 999999.9999999404}, {3., 
               1.1525578908370733`*^6}, {4., 1.5418233817502856`*^6}, {5., 
               4.985313822363853*^6}, {
               5.624275909432413, -6.430577047419526*^6}}], 
              
              LineBox[{{9.895513307364272, 8.714550267432176*^6}, {10., 
               2.1654482307367325`*^6}, {11., 2.0230926071808338`*^6}, {12., 
               2.1900620470665097`*^6}, {13., 3.0351275243627876`*^6}, {14., 
               6.4001478747115135`*^6}, {15., -2.2620179784175456`*^6}, {
               15.810639520907815`, -6.430577047419526*^6}}], 
              
              LineBox[{{16.116307367862273`, -6.430577047419526*^6}, {17., 
               967886.4817990065}, {18., 1.7612883495577574`*^6}, {
               19., -751154.3043501377}, {20., -423644.72188144736`}, {
               21., -375637.8474615067}, {22., -611887.0103246868}, {23., 
               906718.3461403847}}], 
              
              LineBox[{{7.195839950340375, -6.430577047419526*^6}, {
               7.38393148331323, 8.714550267432176*^6}}]}}}, {}}, {{{1., 
           0.}, {0., 9.32181004920014*^-8}}, {0., 15.20394617742791}}]}, {
        Axes -> False, Frame -> True, FrameStyle -> {{
            RGBColor[0.24720000000000014`, 0.24, 0.6], 
            RGBColor[0.6, 0.24, 0.4428931686004542]}, {Automatic, Automatic}},
          FrameTicks -> {{{{14.5, 
              FormBox["14.5`", TraditionalForm]}, {15., 
              FormBox["15.`", TraditionalForm]}, {15.5, 
              FormBox["15.5`", TraditionalForm]}, {16., 
              FormBox["16.`", TraditionalForm]}, {16.5, 
              FormBox["16.5`", TraditionalForm]}}, {{14.5, 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"-7.552\\\" \[Times] \
10\\^\\\"6\\\"\\), -7.5516039665313065`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {15., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"-2.188\\\" \[Times] \
10\\^\\\"6\\\"\\), -2.18783880331707`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {15.5, 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"3.176\\\" \[Times] \
10\\^\\\"6\\\"\\), 3.1759263598971367`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {16., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"8.54\\\" \[Times] \
10\\^\\\"6\\\"\\), 8.539691523111373`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {16.5, 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"1.39\\\" \[Times] \
10\\^\\\"7\\\"\\), 1.390345668632561`*^7, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}}}, {
           Automatic, Automatic}}, DisplayFunction -> Identity, 
         PlotRangePadding -> {{
            Scaled[0.02], 
            Scaled[0.02]}, {
            Scaled[0.05], 
            Scaled[0.05]}}, AxesOrigin -> {0, 14.53391}, 
         PlotRange -> {{0., 23.}, {14.6045, 16.0163}}, DisplayFunction -> 
         Identity, AspectRatio -> 
         NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
         AxesLabel -> {
           FormBox["\"Time\"", TraditionalForm], 
           FormBox["\"Silver Price\"", TraditionalForm]}, 
         AxesOrigin -> {0, 14.53391}, DisplayFunction :> Identity, 
         Frame -> {{False, False}, {False, False}}, 
         FrameLabel -> {{None, None}, {None, None}}, 
         FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
         GridLines -> {None, None}, GridLinesStyle -> Directive[
           GrayLevel[0.5, 0.4]], ImageSize -> 600, Method -> {}, 
         PlotRange -> {{0., 23.}, {14.6045, 16.0163}}, PlotRangeClipping -> 
         True, PlotRangePadding -> {{
            Scaled[0.02], 
            Scaled[0.02]}, {
            Scaled[0.05], 
            Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
       "\"Ag Price\""}, "Labeled", DisplayFunction -> (GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ), 
      InterpretationFunction -> (RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )], "\"Net Value\""}, 
    "Labeled", DisplayFunction -> (GridBox[{{
        TagBox[
         ItemBox[
          PaneBox[
           TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
           BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
         "SkipImageSizeLevel"], 
        ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
      GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
      AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      BaselinePosition -> {1, 1}]& ), 
    InterpretationFunction -> (RowBox[{"Labeled", "[", 
       RowBox[{#, ",", #2, ",", "Right"}], "]"}]& )],"\"Time\""},
  "Labeled",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}, {
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, 
    GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
    BaselinePosition -> {1, 1}]& ),
  InterpretationFunction->(RowBox[{"Labeled", "[", 
     RowBox[{#, ",", #2, ",", "Bottom"}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.656809441358307*^9, 3.656809463542344*^9}, {
   3.656809581260227*^9, 3.656809637800096*^9}, 3.656809669060959*^9, {
   3.65680977536656*^9, 3.656809806265894*^9}, {3.656809867455833*^9, 
   3.6568098842184467`*^9}, 3.656810433922235*^9, {3.657286899111112*^9, 
   3.657286964218913*^9}, 3.657287022925918*^9, 3.657287053414268*^9, 
   3.657291637327311*^9, 3.657291698316473*^9, 3.65729174817239*^9, 
   3.6572961109198*^9, 3.657296145363182*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Last", "@", "value"}], "-", 
  RowBox[{"10", "^", "6"}]}]], "Input",
 CellChangeTimes->{{3.6572879148140907`*^9, 3.657287928280067*^9}}],

Cell[BoxData[
 RowBox[{"-", "93281.65385961533`"}]], "Output",
 CellChangeTimes->{{3.657287918225649*^9, 3.657287928838368*^9}, 
   3.657291633305215*^9, {3.657291685499691*^9, 3.657291689676127*^9}, 
   3.6572917457871943`*^9, 3.657296203781217*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Two", " ", "axis", " ", "list", " ", "plot", " ", "adopted", " ", "from", 
    " ", "docs"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TwoAxisListPlot", "[", 
     RowBox[{"{", 
      RowBox[{"f_", ",", " ", "g_"}], "}"}], "]"}], ":=", 
    RowBox[{"TwoAxisListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", " ", "g"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TwoAxisListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f_", ",", "g_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "opts1___", "}"}], ",", " ", 
        RowBox[{"{", "opts2___", "}"}]}], "}"}], ",", " ", 
      RowBox[{"rTickAcc_Integer:", "4"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fgraph", ",", "ggraph", ",", "frange", ",", "grange", ",", "fticks", 
        ",", "gticks", ",", "fstyle", ",", " ", "gstyle"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "plot", " ", "style"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fstyle", " ", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "opts1", "}"}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"PlotStyle", "\[Rule]", "a_"}], ")"}], "\[RuleDelayed]", 
            "a"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gstyle", " ", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "opts2", "}"}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"PlotStyle", "\[Rule]", "a_"}], ")"}], "\[RuleDelayed]", 
            "a"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fgraph", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ColorData", "[", "1", "]"}], "[", "1", "]"}], ",", " ",
              "fstyle"}], "}"}]}], ",", " ", "opts1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ggraph", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ColorData", "[", "1", "]"}], "[", "2", "]"}], ",", " ",
              "gstyle"}], "}"}]}], ",", " ", "opts2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frange", ",", "grange"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"PlotRange", "/.", 
             RowBox[{"AbsoluteOptions", "[", 
              RowBox[{"#", ",", "PlotRange"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"fgraph", ",", "ggraph"}], "}"}]}]}], ";", 
       RowBox[{"fticks", "=", 
        RowBox[{"N", "@", 
         RowBox[{"FindDivisions", "[", 
          RowBox[{"frange", ",", "5"}], "]"}]}]}], ";", 
       RowBox[{"gticks", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"fticks", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"#", ",", "rTickAcc"}], "]"}], ",", 
                 "StandardForm"}], "]"}], "&"}], "/@", 
              RowBox[{"Rescale", "[", 
               RowBox[{"fticks", ",", "frange", ",", "grange"}], "]"}]}]}], 
            "}"}]}]}]}]}], ";", 
       RowBox[{"Show", "[", 
        RowBox[{"fgraph", ",", 
         RowBox[{"ggraph", "/.", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"graph_", ",", "s___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{"graph", ",", 
               RowBox[{"RescalingTransform", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "grange"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "frange"}], "}"}]}], 
                "]"}]}], "]"}], ",", "s"}], "]"}]}]}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "1", "]"}], "/@", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fticks", ",", "gticks"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
        "]"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.656809535131706*^9, 3.656809615736188*^9}, 
   3.657807682953431*^9}]
},
WindowSize->{808, 753},
WindowMargins->{{291, Automatic}, {-10, Automatic}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2650, 66, 187, "Input"],
Cell[CellGroupData[{
Cell[3233, 90, 166, 3, 32, "Input"],
Cell[3402, 95, 263, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3702, 105, 221, 4, 32, "Input"],
Cell[3926, 111, 306, 6, 55, "Output"]
}, Open  ]],
Cell[4247, 120, 3228, 85, 302, "Input"],
Cell[7478, 207, 587, 14, 55, "Input"],
Cell[CellGroupData[{
Cell[8090, 225, 240, 4, 55, "Input"],
Cell[8333, 231, 122, 2, 32, "Output"],
Cell[8458, 235, 122, 2, 32, "Output"]
}, Open  ]],
Cell[8595, 240, 3305, 81, 253, "Input"],
Cell[11903, 323, 246, 6, 32, "Input"],
Cell[12152, 331, 3352, 90, 341, "Input"],
Cell[CellGroupData[{
Cell[15529, 425, 1626, 37, 143, "Input"],
Cell[17158, 464, 7674, 148, 362, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24869, 617, 171, 4, 32, "Input"],
Cell[25043, 623, 250, 4, 32, "Output"]
}, Open  ]],
Cell[25308, 630, 5899, 155, 583, "Input"]
}
]
*)

(* End of internal cache information *)
