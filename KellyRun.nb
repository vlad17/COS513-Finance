(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     99398,       2352]
NotebookOptionsPosition[     95871,       2228]
NotebookOutlinePosition[     96205,       2243]
CellTagsIndexPosition[     96162,       2240]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"silver", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Date\>\"", "\[Rule]", "#1"}], ",", 
        RowBox[{"\"\<Value\>\"", "\[Rule]", "#2"}]}], "|>"}], "&"}], "@@@", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<quote-download/XAG.csv\>\"", ",", " ", "\"\<Table\>\""}], 
      "]"}]}], "//", "Rest"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"decisionsRawWithSchema", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<ag-lm-1.csv\>\"", ",", " ", "\"\<Data\>\""}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dates", "=", 
         RowBox[{"First", "/@", "silver"}]}], ",", " ", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "@", "silver"}]}]}], "}"}], ",", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"dates", ",", "  ", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", " ", "n"}], "]"}], 
         ",", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.25", ",", "10"}], "}"}], ",", " ", "n"}], "]"}]}], 
        "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"First", "/@", "silver"}], " ", "\[Equal]", 
     RowBox[{"First", "/@", "decisions"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseRawWithSchema", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<lasso-ag-1.csv\>\"", ",", " ", "\"\<Data\>\""}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.656805642516829*^9, 3.6568057271775713`*^9}, {
  3.656806521973482*^9, 3.656806537057242*^9}, {3.656806576866538*^9, 
  3.656806606162609*^9}, {3.6568066495233994`*^9, 3.656806703566689*^9}, {
  3.656806742598598*^9, 3.6568067824219933`*^9}, {3.656806838855907*^9, 
  3.656806854613645*^9}, {3.656806884705585*^9, 3.6568068934078407`*^9}, {
  3.656810411601328*^9, 3.656810428320326*^9}, {3.65728319133917*^9, 
  3.657283202635228*^9}, {3.6572833526467333`*^9, 3.657283357173815*^9}, {
  3.6572850107224827`*^9, 3.6572850110657988`*^9}, {3.6572857076398973`*^9, 
  3.657285709079067*^9}, {3.657286349397767*^9, 3.6572863843729877`*^9}, {
  3.6578075896846657`*^9, 3.657807589916909*^9}, {3.657807632048141*^9, 
  3.657807655950284*^9}, {3.657831559948848*^9, 3.6578315645175962`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainRaw", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<train.csv\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.657971202824484*^9, 3.657971215197041*^9}, {
  3.65797132899536*^9, 3.6579713293437366`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trainRaw", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.657971221933926*^9, 3.657971224846842*^9}, {
  3.657971311219211*^9, 3.65797131622116*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"dates.22.584.\"\>", ",", "\<\"X1\"\>", 
   ",", "\<\"pred...1.\"\>", ",", "\<\"pred...2.\"\>", 
   ",", "\<\"actual\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.657971225096923*^9, {3.657971313605743*^9, 3.657971330821142*^9}, 
   3.657971372260222*^9, 3.657978452685816*^9, 3.6616137331765423`*^9, 
   3.6616137751820583`*^9, {3.6616138598173*^9, 3.661613884254797*^9}, 
   3.6616146900587063`*^9, 3.661614838422358*^9, 3.6616155983274937`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"decisionsRawWithSchema", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.657285715133581*^9, 3.6572857175517263`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", "\<\"as.Date(dates[783:804])\"\>", 
   ",", "\<\"ex/100\"\>", ",", "\<\"upper/100\"\>", ",", "\<\"lower/100\"\>", 
   ",", "\<\"actuals/100\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.657285717898303*^9, 3.657839038257183*^9, 3.657900994013009*^9, 
   3.657908207358467*^9, 3.657971335170787*^9, 3.6579713727324142`*^9, 
   3.657978452703211*^9, 3.661613775889398*^9, {3.661613860873839*^9, 
   3.661613885045413*^9}, 3.661614690579341*^9, 3.661614838451353*^9, 
   3.661615598345069*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseRawWithSchema", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6578077880739822`*^9, 3.657807789926181*^9}, {
  3.657807835157434*^9, 3.657807836884766*^9}, {3.657831567505134*^9, 
  3.657831597622265*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", "\<\"dates.585.805.\"\>", 
   ",", "\<\"as.vector.pred1...1..\"\>", ",", "\<\"as.vector.pred1...2..\"\>",
    ",", "\<\"as.vector.pred1...3..\"\>", ",", "\<\"as.vector.act1.\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.657807790219996*^9, {3.6578078355927362`*^9, 3.657807837076211*^9}, {
   3.6578315691454573`*^9, 3.657831594584899*^9}, 3.657839038272057*^9, 
   3.657900994765316*^9, 3.657908208070483*^9, 3.65797137322542*^9, 
   3.6579784527236834`*^9, 3.6616137071243687`*^9, 3.66161377657714*^9, {
   3.661613861472158*^9, 3.661613885780595*^9}, 3.661614691145612*^9, 
   3.661614838477532*^9, 3.661615598365159*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"decisionsRaw", "=", 
   RowBox[{"Rest", "@", "decisionsRawWithSchema"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logNormalVar", "[", 
    RowBox[{"mu_", ",", "var_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Exp", "[", "var", "]"}], "-", "1"}], ")"}], 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"2", "mu"}], "+", "var"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decisions", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dates", "=", 
        RowBox[{"decisionsRaw", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"meanLogReturns", "=", 
        RowBox[{"decisionsRaw", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", 
       RowBox[{"varLogReturns", "=", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"decisionsRaw", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "4"}], "]"}], "]"}], "-", 
            RowBox[{"decisionsRaw", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "5"}], "]"}], "]"}]}], 
           RowBox[{"2", "*", "2", " ", 
            RowBox[{"(*", 
             RowBox[{"95", "%", " ", "ci"}], "*)"}]}]], ")"}], "2"]}]}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Date\>\"", "\[Rule]", "#1"}], ",", 
         RowBox[{"\"\<Return\>\"", "\[Rule]", "#2"}], ",", 
         RowBox[{"\"\<Var\>\"", "\[Rule]", "#3"}]}], "|>"}], "&"}], "@@@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"dates", ",", 
         RowBox[{
          RowBox[{"Exp", "[", "meanLogReturns", "]"}], "-", "1"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"logNormalVar", ",", 
           RowBox[{"{", 
            RowBox[{"meanLogReturns", ",", "varLogReturns"}], "}"}]}], 
          "]"}]}], "}"}]}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.65728501380488*^9, 3.6572850369656878`*^9}, {
   3.657285102040361*^9, 3.657285118423678*^9}, {3.6572853734224997`*^9, 
   3.657285466216805*^9}, {3.657285522838579*^9, 3.657285762010478*^9}, {
   3.657285906851521*^9, 3.657285950487563*^9}, {3.657285982415751*^9, 
   3.6572859882791977`*^9}, {3.657286426194031*^9, 3.6572864720733023`*^9}, {
   3.657286926237834*^9, 3.657286954576515*^9}, {3.657287521908414*^9, 
   3.657287522183867*^9}, {3.657291505963832*^9, 3.657291556503409*^9}, {
   3.65729160087525*^9, 3.65729160411765*^9}, 3.657291678521524*^9, {
   3.657291733895733*^9, 3.6572917351856947`*^9}, 3.657296097146632*^9, {
   3.6578077928933372`*^9, 3.657807866430084*^9}, {3.657809394226419*^9, 
   3.657809399620667*^9}, {3.657810186957*^9, 3.657810187104187*^9}, {
   3.657810221676939*^9, 3.657810221987812*^9}, {3.657810342264542*^9, 
   3.657810342376409*^9}, {3.657811212758711*^9, 3.657811231914421*^9}, {
   3.657831604437524*^9, 3.6578316123332863`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sparseRaw", "=", 
   RowBox[{"Rest", "@", "sparseRawWithSchema"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparse", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Date\>\"", "\[Rule]", "#2"}], ",", 
       RowBox[{"\"\<Returns\>\"", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", "#4", "]"}], "-", "1"}], ")"}]}]}], "|>"}], 
     "&"}], "@@@", "sparseRaw"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.65728501380488*^9, 3.6572850369656878`*^9}, {
   3.657285102040361*^9, 3.657285118423678*^9}, {3.6572853734224997`*^9, 
   3.657285466216805*^9}, {3.657285522838579*^9, 3.657285762010478*^9}, {
   3.657285906851521*^9, 3.657285950487563*^9}, {3.657285982415751*^9, 
   3.6572859882791977`*^9}, {3.657286426194031*^9, 3.6572864720733023`*^9}, {
   3.657286926237834*^9, 3.657286954576515*^9}, {3.657287521908414*^9, 
   3.657287522183867*^9}, {3.657291505963832*^9, 3.657291556503409*^9}, {
   3.65729160087525*^9, 3.65729160411765*^9}, 3.657291678521524*^9, {
   3.657291733895733*^9, 3.6572917351856947`*^9}, 3.657296097146632*^9, {
   3.6578077928933372`*^9, 3.657807866430084*^9}, {3.657809394226419*^9, 
   3.657809399620667*^9}, {3.657810186957*^9, 3.657810187104187*^9}, {
   3.657810221676939*^9, 3.657810221987812*^9}, {3.657810342264542*^9, 
   3.657810342376409*^9}, {3.657811212758711*^9, 3.657811231914421*^9}, {
   3.657831604437524*^9, 3.657831637827664*^9}, {3.657831714802313*^9, 
   3.657831730243388*^9}, {3.661613094922439*^9, 3.661613095362811*^9}, {
   3.661613172954315*^9, 3.661613173862471*^9}, {3.661613473723957*^9, 
   3.66161347614929*^9}, 3.6616136580075817`*^9, {3.66161381425215*^9, 
   3.661613826061385*^9}, {3.6616138889336033`*^9, 3.6616138892851477`*^9}, {
   3.661614592022921*^9, 3.661614595428039*^9}, {3.661614831453273*^9, 
   3.661614832468596*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseRawWithSchema", "[", 
  RowBox[{"[", 
   RowBox[{";;", "4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.661613181630056*^9, 3.661613189290694*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"\"\>", ",", "\<\"dates.585.805.\"\>", 
     ",", "\<\"as.vector.pred1...1..\"\>", 
     ",", "\<\"as.vector.pred1...2..\"\>", 
     ",", "\<\"as.vector.pred1...3..\"\>", ",", "\<\"as.vector.act1.\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"2015-02-03\"\>", ",", 
     RowBox[{"-", "0.00064025019248209`"}], ",", 
     RowBox[{"-", "0.00171955528108571`"}], ",", 
     RowBox[{"-", "0.00323563364519442`"}], ",", "0.00855305351432278`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"2015-02-04\"\>", ",", 
     RowBox[{"-", "1.43817365802455`*^-6"}], ",", "0.000131578727304149`", 
     ",", 
     RowBox[{"-", "0.00271516036516429`"}], ",", "0.00166039253380257`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"2015-02-05\"\>", ",", 
     RowBox[{"-", "0.000367536555426598`"}], ",", 
     RowBox[{"-", "0.000121158100577135`"}], ",", "0.000466133983418977`", 
     ",", 
     RowBox[{"-", "0.00335822502952654`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6616131895868273`*^9, 3.661613780959031*^9, {3.6616138635144863`*^9, 
   3.6616138906334476`*^9}, 3.661614694371166*^9, 3.661614838520976*^9, 
   3.66161559839214*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sparseRaw", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}], "-", 
   RowBox[{"sparseRaw", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "//", "Mean"}]], "Input",
 CellChangeTimes->{{3.661612721300869*^9, 3.661612747984223*^9}}],

Cell[BoxData["0.0004303282706422869`"], "Output",
 CellChangeTimes->{{3.6616127324655046`*^9, 3.661612748324147*^9}, 
   3.661612794831526*^9, 3.66161309682655*^9, 3.661613479988317*^9, 
   3.6616137126571283`*^9, 3.661613781559203*^9, {3.661613864147334*^9, 
   3.661613891269552*^9}, 3.661614631255279*^9, {3.6616146743249073`*^9, 
   3.661614695449535*^9}, 3.661614838545032*^9, 3.661615598408969*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", "\"\<Returns\>\"", "]"}], "&"}], "/@", "sparse"}], "//",
   "Mean"}]], "Input",
 CellChangeTimes->{{3.661612852686572*^9, 3.6616129037997437`*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.0009019213288328552`"}]], "Output",
 CellChangeTimes->{{3.661612864339755*^9, 3.6616129046471043`*^9}, 
   3.661613100624449*^9, 3.6616134830388823`*^9, 3.66161366475224*^9, 
   3.6616137141434193`*^9, 3.6616137823892937`*^9, {3.6616138651625443`*^9, 
   3.661613892027515*^9}, 3.661614696033258*^9, 3.6616148385724373`*^9, 
   3.661615598426478*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"train", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Date\>\"", "\[Rule]", "#1"}], ",", 
       RowBox[{"\"\<Returns\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"Exp", "[", "#2", "]"}], "-", "1"}]}]}], "|>"}], "&"}], "@@@", 
    RowBox[{"Rest", "@", "trainRaw"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657971259119012*^9, 3.657971298834092*^9}, {
   3.657974294000224*^9, 3.657974295804555*^9}, {3.657974384926338*^9, 
   3.657974385025457*^9}, {3.661613110672166*^9, 3.66161311170009*^9}, 
   3.661613552116173*^9, {3.6616138367451887`*^9, 3.6616138368609858`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"joined", "=", 
   RowBox[{"JoinAcross", "[", 
    RowBox[{"decisions", ",", " ", "silver", ",", 
     RowBox[{"Key", "[", "\"\<Date\>\"", "]"}], ",", "\"\<Left\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"joinedSparse", "=", 
   RowBox[{"JoinAcross", "[", 
    RowBox[{"sparse", ",", " ", "silver", ",", 
     RowBox[{"Key", "[", "\"\<Date\>\"", "]"}], ",", "\"\<Left\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.657286487160692*^9, 3.6572865296268997`*^9}, {
  3.65780788610122*^9, 3.6578078943907547`*^9}, {3.657831641121912*^9, 
  3.657831646114133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Length", "@", "joined"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "joinedSparse"}]}], "Input",
 CellChangeTimes->{{3.65729601514282*^9, 3.657296017186095*^9}, {
  3.657807895537224*^9, 3.6578078984810038`*^9}, {3.657831649830806*^9, 
  3.6578316517322206`*^9}}],

Cell[BoxData["22"], "Output",
 CellChangeTimes->{
  3.6572960254328003`*^9, {3.657807898791162*^9, 3.657807901673956*^9}, 
   3.6578094099093113`*^9, 3.657810194072935*^9, 3.657810224271822*^9, 
   3.657810344856503*^9, {3.6578316480571823`*^9, 3.6578316522282*^9}, 
   3.657839038329905*^9, 3.657900998464251*^9, 3.6579082210340223`*^9, 
   3.6579713762868443`*^9, 3.657978452769822*^9, 3.6616137849863997`*^9, 
   3.661614699962977*^9, 3.6616148386111727`*^9, 3.661615598459876*^9}],

Cell[BoxData["221"], "Output",
 CellChangeTimes->{
  3.6572960254328003`*^9, {3.657807898791162*^9, 3.657807901673956*^9}, 
   3.6578094099093113`*^9, 3.657810194072935*^9, 3.657810224271822*^9, 
   3.657810344856503*^9, {3.6578316480571823`*^9, 3.6578316522282*^9}, 
   3.657839038329905*^9, 3.657900998464251*^9, 3.6579082210340223`*^9, 
   3.6579713762868443`*^9, 3.657978452769822*^9, 3.6616137849863997`*^9, 
   3.661614699962977*^9, 3.6616148386111727`*^9, 3.661615598460438*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pp", "[", "x_", "]"}], ":=", 
  RowBox[{"Prepend", "[", 
   RowBox[{"x", ",", 
    RowBox[{"First", "@", "x"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6578125606591997`*^9, 3.657812567839127*^9}, 
   3.661613742339816*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"invest", "=", "1000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeInvestment", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"money_", ",", "ownedCommodities_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"leverage_", ",", " ", "currPrice_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toSell", "=", 
      RowBox[{"ownedCommodities", "*", "currPrice"}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newMoney", "=", 
        RowBox[{"money", "+", "toSell"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"toSpend", "=", 
          RowBox[{"newMoney", "*", "leverage"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newCommodities", "=", 
            RowBox[{"toSpend", "/", "currPrice"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"newMoney", "-", "toSpend"}], ",", " ", 
            "newCommodities"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{"FoldList", "[", 
    RowBox[{"makeInvestment", ",", " ", 
     RowBox[{"{", 
      RowBox[{"invest", ",", "0"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Return\>\"", "]"}], "/", 
          RowBox[{"stddev", "^", "2"}]}], ",", 
         RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "}"}], "&"}], "/@", 
      "joined"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prices", "=", 
   RowBox[{"pp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", "joined"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"value", "=", 
   RowBox[{
    RowBox[{"First", "/@", "state"}], "+", 
    RowBox[{
     RowBox[{"Last", "/@", "state"}], "*", "prices"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Last", "@", "value"}], " ", "-", 
  RowBox[{"10", "^", "6"}]}]}], "Input",
 CellChangeTimes->{{3.656806797742342*^9, 3.65680680551661*^9}, {
   3.6568068667634478`*^9, 3.6568068961836557`*^9}, 3.6568071118479033`*^9, 
   3.6568080085873404`*^9, {3.656808042121334*^9, 3.656808047353702*^9}, {
   3.656808078737555*^9, 3.656808160610395*^9}, {3.6568081943420143`*^9, 
   3.6568083266105947`*^9}, {3.656808374146112*^9, 3.6568084577507133`*^9}, {
   3.656808572060007*^9, 3.656808576116631*^9}, {3.656808619870462*^9, 
   3.656808620876823*^9}, {3.656808652067164*^9, 3.656808656687986*^9}, {
   3.656808925788609*^9, 3.6568090161727057`*^9}, {3.6568090852326317`*^9, 
   3.656809114604982*^9}, {3.657286589125533*^9, 3.657286592415312*^9}, {
   3.6572866359891644`*^9, 3.657286670002015*^9}, {3.6572867972979307`*^9, 
   3.657286815766407*^9}, {3.657286857393908*^9, 3.657286884211424*^9}, {
   3.657287010580776*^9, 3.6572870156844397`*^9}, {3.657296132991131*^9, 
   3.65729614235765*^9}, {3.657808097506473*^9, 3.657808100375308*^9}, {
   3.657808141309396*^9, 3.6578081415225153`*^9}, 3.657810391626779*^9, {
   3.657831980061379*^9, 3.6578319853517923`*^9}, {3.657839077647471*^9, 
   3.657839111447879*^9}, {3.657839151791501*^9, 3.657839151931624*^9}, {
   3.657974466758067*^9, 3.657974468894287*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          FractionBox["6.37305767820726`", 
           SuperscriptBox["stddev", "2"]], "+", 
          FractionBox[
           RowBox[{"0.00001588045914760819`", " ", 
            RowBox[{"(", 
             RowBox[{"1.`*^6", "+", 
              FractionBox["6.37305767820726`", 
               SuperscriptBox["stddev", "2"]]}], ")"}]}], 
           SuperscriptBox["stddev", "2"]], "+", 
          TemplateBox[{"26"},
           "OutputSizeLimit`Skeleton",
           DisplayFunction->(FrameBox[
             RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
             Background -> GrayLevel[0.75], 
             BaseStyle -> {
              "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
               ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
             ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
             GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
          FractionBox[
           RowBox[{"0.00006208447384106405`", " ", 
            RowBox[{"(", 
             RowBox[{"1.`*^6", "+", 
              FractionBox["6.37305767820726`", 
               SuperscriptBox["stddev", "2"]], "+", 
              TemplateBox[{"27"},
               "OutputSizeLimit`Skeleton",
               DisplayFunction->(FrameBox[
                 
                 RowBox[{
                  "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                 Background -> GrayLevel[0.75], 
                 BaseStyle -> {
                  "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                   ShowStringCharacters -> False}, BaselinePosition -> 
                 Baseline, ContentPadding -> False, FrameMargins -> 1, 
                 FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}], 
             ")"}]}], 
           SuperscriptBox["stddev", "2"]], "-", 
          FractionBox[
           RowBox[{"0.0002422751591843915`", " ", 
            RowBox[{"(", 
             RowBox[{"1.`*^6", "+", 
              FractionBox["6.37305767820726`", 
               SuperscriptBox["stddev", "2"]], "+", 
              FractionBox[
               RowBox[{"0.00001588045914760819`", " ", 
                RowBox[{"(", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                 ")"}]}], 
               SuperscriptBox["stddev", "2"]], "+", 
              TemplateBox[{"26"},
               "OutputSizeLimit`Skeleton",
               DisplayFunction->(FrameBox[
                 
                 RowBox[{
                  "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                 Background -> GrayLevel[0.75], 
                 BaseStyle -> {
                  "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                   ShowStringCharacters -> False}, BaselinePosition -> 
                 Baseline, ContentPadding -> False, FrameMargins -> 1, 
                 FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
              FractionBox[
               RowBox[{"0.00006208447384106405`", " ", 
                RowBox[{"(", 
                 RowBox[{"1.`*^6", "+", 
                  TemplateBox[{"28"},
                   "OutputSizeLimit`Skeleton",
                   DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}],
                  ")"}]}], 
               SuperscriptBox["stddev", "2"]]}], ")"}]}], 
           SuperscriptBox["stddev", "2"]]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{74., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{67., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 30, 30653077712019356746, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{73., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 30, 30653077712019356746, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{56., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 30, 30653077712019356746, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{100., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[30]]], "Output",
 CellChangeTimes->{{3.657839083651434*^9, 3.657839111868865*^9}, 
   3.657839152271551*^9, 3.657900941323862*^9, 3.657901000145821*^9, 
   3.657908222611741*^9, 3.657971377862131*^9, 3.657974469504475*^9, 
   3.65797848841294*^9, 3.661614701801765*^9, 3.661614838644487*^9, 
   3.66161563299865*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Labeled", "[", 
  RowBox[{
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"TwoAxisListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pp", "@", "prices"}], ",", "value"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time\>\"", ",", "\"\<Silver Price\>\""}], 
               "}"}]}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time\>\"", ",", " ", "\"\<Net Value\>\""}], 
               "}"}]}]}], "}"}]}], "}"}]}], "]"}], ",", "\"\<Ag Price\>\"", 
       ",", " ", "Left"}], "]"}], ",", "\"\<Net Value\>\"", ",", " ", 
     "Right"}], "]"}], ",", "\"\<Time\>\"", ",", " ", "Bottom"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.656807638897766*^9, 3.6568076451392107`*^9}, {
   3.656809125796892*^9, 3.656809137882715*^9}, {3.656809229337903*^9, 
   3.656809269281384*^9}, {3.656809321288967*^9, 3.6568094630059023`*^9}, {
   3.656809621205243*^9, 3.6568097079679127`*^9}, {3.6568097724792137`*^9, 
   3.656809774772797*^9}, {3.657286912181917*^9, 3.6572869127733297`*^9}, {
   3.657287021900613*^9, 3.657287052401288*^9}, {3.657809588009139*^9, 
   3.657809590500804*^9}, {3.657812612744878*^9, 3.657812620617111*^9}, {
   3.657832287485591*^9, 3.657832314643202*^9}, {3.657839066525794*^9, 
   3.657839069848248*^9}, 3.661613786516889*^9}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{
     TemplateBox[{
       GraphicsBox[{{{}, {{{}, {}, {
             Hue[0.67, 0.6, 0.6], 
             Directive[
              PointSize[0.012833333333333334`], 
              AbsoluteThickness[1.6], 
              RGBColor[0.24720000000000014`, 0.24, 0.6]], 
             LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQDQEf7HVSJR9FhOs5QAUcUPkcaHwBBw1+7q3LImF8
EYdSplkc0nEwvoSD1IFoBUdBGF/G4RWLiaDZHF0oX8Gh5tOGgOxbML6Sg/5d
FbZGU5h6FYeEpxeUblvC+GoO5p2OCU83wNRrOMwxXrTF3ALG14Lqh/F1HCy3
nCjbVw/j6zmIyp58at8CM8/AIfldlJPdCRjf0GHi2xp70zp9KN/IgU9309z3
z2F8Y4c47xPsttUwvomD//opqR2LYXxTh2Wzjyhs2ATjmzlsYH7eo3EWxjd3
OLJRL2/xQhjfwuHAm3k2OiwGDgBZ7lYC
              "]]}}}, {}}, 
         GeometricTransformationBox[{{}, {{{}, {}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[0.012833333333333334`], 
               AbsoluteThickness[1.6], 
               RGBColor[0.6, 0.24, 0.4428931686004542]], 
              LineBox[{{1., 1.*^6}, {2., 1.*^6}}]}}}, {}}, {{{1., 0.}, {0., 
           7.059000000000006*^-7}}, {0., 14.6045}}]}, {
        Axes -> False, Frame -> True, FrameStyle -> {{
            RGBColor[0.24720000000000014`, 0.24, 0.6], 
            RGBColor[0.6, 0.24, 0.4428931686004542]}, {Automatic, Automatic}},
          FrameTicks -> {{{{14.5, 
              FormBox["14.5`", TraditionalForm]}, {15., 
              FormBox["15.`", TraditionalForm]}, {15.5, 
              FormBox["15.5`", TraditionalForm]}, {16., 
              FormBox["16.`", TraditionalForm]}, {16.5, 
              FormBox["16.5`", TraditionalForm]}}, {{14.5, 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"-148000.\\\\\\\
\"\\\", -148037.96571752056`, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {15., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"560300.\\\\\\\"\
\\\", 560277.6597251743`, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {15.5, 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"1.269\\\" \[Times] \
10\\^\\\"6\\\"\\), 1.268593285167873`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {16., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"1.977\\\" \[Times] \
10\\^\\\"6\\\"\\), 1.9769089106105678`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {16.5, 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\(\\\"2.685\\\" \[Times] \
10\\^\\\"6\\\"\\), 2.6852245360532627`*^6, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}}}, {
           Automatic, Automatic}}, DisplayFunction -> Identity, 
         PlotRangePadding -> {{
            Scaled[0.02], 
            Scaled[0.02]}, {
            Scaled[0.05], 
            Scaled[0.05]}}, AxesOrigin -> {0, 14.53391}, 
         PlotRange -> {{0., 24.}, {14.6045, 16.0163}}, DisplayFunction -> 
         Identity, AspectRatio -> 
         NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
         AxesLabel -> {
           FormBox["\"Time\"", TraditionalForm], 
           FormBox["\"Silver Price\"", TraditionalForm]}, 
         AxesOrigin -> {0, 14.53391}, DisplayFunction :> Identity, 
         Frame -> {{False, False}, {False, False}}, 
         FrameLabel -> {{None, None}, {None, None}}, 
         FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
         GridLines -> {None, None}, GridLinesStyle -> Directive[
           GrayLevel[0.5, 0.4]], ImageSize -> 600, Method -> {}, 
         PlotRange -> {{0., 24.}, {14.6045, 16.0163}}, PlotRangeClipping -> 
         True, PlotRangePadding -> {{
            Scaled[0.02], 
            Scaled[0.02]}, {
            Scaled[0.05], 
            Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
       "\"Ag Price\""}, "Labeled", DisplayFunction -> (GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ), 
      InterpretationFunction -> (RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )], "\"Net Value\""}, 
    "Labeled", DisplayFunction -> (GridBox[{{
        TagBox[
         ItemBox[
          PaneBox[
           TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
           BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
         "SkipImageSizeLevel"], 
        ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
      GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
      AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      BaselinePosition -> {1, 1}]& ), 
    InterpretationFunction -> (RowBox[{"Labeled", "[", 
       RowBox[{#, ",", #2, ",", "Right"}], "]"}]& )],"\"Time\""},
  "Labeled",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}, {
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, 
    GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
    BaselinePosition -> {1, 1}]& ),
  InterpretationFunction->(RowBox[{"Labeled", "[", 
     RowBox[{#, ",", #2, ",", "Bottom"}], "]"}]& )]], "Output",
 CellChangeTimes->{3.657978506006866*^9, 3.6616148387051067`*^9, 
  3.661615650341415*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"silver", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.657974268785754*^9, 3.657974274249267*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Date\"\>", "\[Rule]", "\<\"2010-11-03\"\>"}], ",", 
   RowBox[{"\<\"Value\"\>", "\[Rule]", "24.762`"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.657974274556335*^9, 3.657974304431027*^9}, 
   3.657978506129711*^9, 3.6616148387892723`*^9, 3.66161565045297*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparse", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6579760834666157`*^9, 3.6579760886430683`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Date\"\>", "\[Rule]", "\<\"2015-02-03\"\>"}], ",", 
   RowBox[{"\<\"Returns\"\>", "\[Rule]", 
    RowBox[{"-", "0.001718077692956177`"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6579760889184504`*^9, 3.657978506150577*^9, 
  3.661614838827215*^9, 3.661615650469809*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparse", "//", "Last"}]], "Input",
 CellChangeTimes->{{3.657976089729939*^9, 3.6579760931983128`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Date\"\>", "\[Rule]", "\<\"2015-10-15\"\>"}], ",", 
   RowBox[{"\<\"Returns\"\>", "\[Rule]", "0.0009546370354949207`"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.657976093367939*^9, 3.6579785061718597`*^9, 
  3.6616148388927593`*^9, 3.661615650486513*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"train", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.657974277868288*^9, 3.657974281042913*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Date\"\>", "\[Rule]", "\<\"4/29/2013\"\>"}], ",", 
   RowBox[{"\<\"Returns\"\>", "\[Rule]", "0.21207466919971218`"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.657974281293788*^9, 3.657974306737938*^9}, 
   3.6579785061914387`*^9, 3.661614838931635*^9, 3.6616156505029993`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stddev", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", "silver"}], "//", 
   "StandardDeviation"}]}]], "Input",
 CellChangeTimes->{{3.6579743307534533`*^9, 3.657974345410112*^9}, {
  3.6579744402177773`*^9, 3.6579744414613647`*^9}}],

Cell[BoxData["7.714958479968682`"], "Output",
 CellChangeTimes->{
  3.6579743458223677`*^9, 3.657974390709752*^9, {3.657974425605304*^9, 
   3.6579744429500237`*^9}, 3.657978506213835*^9, 3.6616148389932823`*^9, 
   3.661615650524475*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stddev", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<Returns\>\"", "]"}], "&"}], "/@", "train"}], "//",
    "StandardDeviation"}]}]], "Input",
 CellChangeTimes->{{3.657971391211072*^9, 3.6579713927927732`*^9}, {
  3.6579714381992397`*^9, 3.657971439852315*^9}}],

Cell[BoxData["0.20196509824819203`"], "Output",
 CellChangeTimes->{
  3.657971441677588*^9, 3.65797431178144*^9, {3.657974369944277*^9, 
   3.657974388114687*^9}, 3.657974591811871*^9, 3.6579785062365303`*^9, 
   3.661613523074085*^9, 3.661613564830049*^9, {3.6616137473152246`*^9, 
   3.661613790080694*^9}, 3.661614681054532*^9, 3.661614839036381*^9, 
   3.6616156505417557`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"invest", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeInvestmentSparse", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"money_", ",", "ownedCommodities_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"edge_", ",", "currPrice_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toSell", "=", 
      RowBox[{"ownedCommodities", "*", "currPrice"}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newMoney", "=", 
        RowBox[{"money", "+", "toSell"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"toSpend", "=", 
          RowBox[{"newMoney", " ", "*", " ", 
           RowBox[{"edge", "/", 
            RowBox[{"stddev", "^", "2"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newCommodities", "=", 
            RowBox[{"toSpend", "/", "currPrice"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"newMoney", "-", "toSpend"}], ",", " ", 
            "newCommodities"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateSparse", "=", 
   RowBox[{"FoldList", "[", 
    RowBox[{"makeInvestmentSparse", ",", 
     RowBox[{"{", 
      RowBox[{"invest", ",", " ", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", "\"\<Returns\>\"", "]"}], ",", 
         RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "}"}], "&"}], "/@", 
      "joinedSparse"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pricesSparse", "=", 
   RowBox[{"pp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", "joinedSparse"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valueSparse", "=", 
   RowBox[{
    RowBox[{"First", "/@", "stateSparse"}], "+", 
    RowBox[{
     RowBox[{"stateSparse", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", "pricesSparse"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.657807931712964*^9, 3.657808026232649*^9}, {
   3.657808148417593*^9, 3.6578081541821537`*^9}, {3.6578082495799932`*^9, 
   3.6578082623643293`*^9}, {3.657808312300622*^9, 3.657808316206072*^9}, {
   3.657808389862636*^9, 3.657808681573633*^9}, {3.6578087390986767`*^9, 
   3.6578087394459343`*^9}, {3.657809567548814*^9, 3.6578095677468157`*^9}, {
   3.6578096137914743`*^9, 3.6578096943951607`*^9}, {3.6578097377407703`*^9, 
   3.6578097379851923`*^9}, {3.657809880407792*^9, 3.657809995089163*^9}, {
   3.657810047500515*^9, 3.657810054980256*^9}, {3.6578101363090363`*^9, 
   3.657810156130596*^9}, {3.65781037064085*^9, 3.6578103972876043`*^9}, {
   3.657810493592802*^9, 3.6578106474712553`*^9}, {3.657810778311906*^9, 
   3.6578108246894007`*^9}, {3.657811010875854*^9, 3.657811013568528*^9}, {
   3.657811252818816*^9, 3.657811256871009*^9}, {3.6578112970066023`*^9, 
   3.6578112975432777`*^9}, {3.657811340273428*^9, 3.6578113426780787`*^9}, {
   3.65781137530328*^9, 3.65781137595359*^9}, {3.657811466354604*^9, 
   3.657811466618636*^9}, {3.657811538832245*^9, 3.65781155057051*^9}, {
   3.657811597415887*^9, 3.6578116068711767`*^9}, {3.657811788052796*^9, 
   3.657811794298174*^9}, {3.6578118445436563`*^9, 3.657811869307275*^9}, {
   3.657811910424323*^9, 3.65781214745044*^9}, {3.6578122420916367`*^9, 
   3.657812269483489*^9}, {3.6578123556835012`*^9, 3.657812359637806*^9}, {
   3.657812419022318*^9, 3.657812464261471*^9}, {3.657812574993153*^9, 
   3.657812585528028*^9}, {3.657812634706963*^9, 3.657812635373179*^9}, {
   3.657831661581546*^9, 3.657831667363652*^9}, {3.657832001279263*^9, 
   3.657832042730298*^9}, {3.657832074403233*^9, 3.657832129195593*^9}, {
   3.6578321928766727`*^9, 3.657832201098682*^9}, {3.657832260001725*^9, 
   3.6578322858955107`*^9}, {3.657832322798876*^9, 3.657832324184436*^9}, {
   3.657832373261435*^9, 3.657832391582864*^9}, {3.6578324416734943`*^9, 
   3.657832452886701*^9}, {3.657832538757846*^9, 3.6578325393573427`*^9}, {
   3.657832591124441*^9, 3.657832646698277*^9}, {3.6578327625669003`*^9, 
   3.657832762738205*^9}, {3.65783925976475*^9, 3.6578392948311872`*^9}, {
   3.65797141679919*^9, 3.657971455764757*^9}, {3.6579757636713123`*^9, 
   3.6579757746866417`*^9}, {3.6579758636452093`*^9, 3.657975892248171*^9}, {
   3.657981333930299*^9, 3.65798134325334*^9}, 3.66161352062925*^9, 
   3.6616146849058657`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"valueSparse", "-", "invest"}], "invest"], "//", "Last"}]], "Input",\

 CellChangeTimes->{{3.657981344715016*^9, 3.657981345607905*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.006570602186324`"}]], "Output",
 CellChangeTimes->{
  3.6579813460711308`*^9, {3.661613585947672*^9, 3.661613594218796*^9}, 
   3.661613725264451*^9, 3.661613761477558*^9, 3.6616137933985577`*^9, 
   3.66161384834217*^9, 3.661613899270911*^9, {3.661614616177314*^9, 
   3.661614658756925*^9}, 3.66161470780435*^9, 3.661614839140524*^9, 
   3.661615650566258*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"valueSparse", "-", "invest"}], "invest"], "//", 
  "StandardDeviation"}]], "Input",
 CellChangeTimes->{{3.657981347067978*^9, 3.6579813500699053`*^9}}],

Cell[BoxData["0.0027123801149148297`"], "Output",
 CellChangeTimes->{3.657981350576785*^9, 3.6616135876652184`*^9, 
  3.6616137958769417`*^9, 3.6616138505128937`*^9, 3.661613900573584*^9, 
  3.6616146461897078`*^9, 3.661614713449177*^9, 3.661614839156659*^9, 
  3.6616156505880117`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pp", "@", "pricesSparse"}], ",", "valueSparse"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{"#", ",", "10"}], "]"}]}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<Trading Day\>\"", ",", " ", "\"\<Value ($)\>\""}], "}"}]}], 
   ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<r=0 Trading performance vs. XAG\>\"", ",", "20"}], "]"}]}], 
   ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "invest"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "valueSparse"}], "+", "1"}], ",", "invest"}],
         "}"}]}], "}"}], "]"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6579757783076153`*^9, 3.6579758788822937`*^9}, {
  3.661615589527081*^9, 3.661615593874275*^9}, {3.661615881789686*^9, 
  3.661615965366001*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1: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
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.007333333333333334], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1: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
0P3UxcNy1bBM28sUPx7SpsL/pLw/35/j9gJz
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, 
    FormBox[
     StyleBox["\"Trading Day\"", 10, StripOnInput -> False], TraditionalForm]},
  AxesOrigin->{0, 14.113195000000001`},
  DisplayFunction->Identity,
  Epilog->LineBox[{{-1, 15}, {223, 15}}],
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->600,
  Method->{},
  PlotLabel->FormBox[
    StyleBox[
    "\"r=0 Trading performance vs. XAG\"", 20, StripOnInput -> False], 
    TraditionalForm],
  PlotRange->{{0., 223.}, {14.2814, 17.6455}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.661615941065446*^9, 3.6616159657558517`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialData", "[", 
  RowBox[{"\"\<SP500\>\"", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
    RowBox[{"{", 
     RowBox[{"2015", ",", "10", ",", "15"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6579764533879766`*^9, 3.6579765899818983`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2015", ",", "10", ",", "15"}], "}"}], ",", "2023.859985`"}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6579765148847227`*^9, 3.657976591740164*^9}, 
   3.6579785095778*^9, 3.661614841408085*^9, 3.661615652724943*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialData", "[", 
  RowBox[{"\"\<SP500\>\"", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
    RowBox[{"{", 
     RowBox[{"2015", ",", "02", ",", "03"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.657976600790761*^9, 3.657976628288295*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2015", ",", "2", ",", "3"}], "}"}], ",", "2050.030029`"}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.657976628894835*^9, 3.657978510260343*^9, 
  3.661614842128624*^9, 3.6616156530927267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{"2050.030029`", "-", "2023.859985`"}], "2050.030029`"]], "Input",
 CellChangeTimes->{{3.6579767361123257`*^9, 3.6579767425474567`*^9}}],

Cell[BoxData["0.012765688126415226`"], "Output",
 CellChangeTimes->{3.657976742882451*^9, 3.65797851028058*^9, 
  3.661614842150279*^9, 3.661615653111966*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"stateSparse", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", "pricesSparse"}], "//", 
    "Abs"}], "//", "Max"}], "//", 
  RowBox[{
   RowBox[{"#", "/", "invest"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.657980999591713*^9, 3.65798101240919*^9}, {
  3.657981084400878*^9, 3.657981098386483*^9}}],

Cell[BoxData["0.2216459944707992`"], "Output",
 CellChangeTimes->{
  3.6579810024136953`*^9, {3.65798108753493*^9, 3.657981098826891*^9}, 
   3.661614842168874*^9, 3.661615653132369*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"invest", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rectifier", "=", 
   RowBox[{
    RowBox[{"#", " ", 
     RowBox[{"UnitStep", "[", "#", "]"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "=", "i"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"makeInvestmentSparse", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"money_", ",", "ownedCommodities_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"edge_", ",", "currPrice_"}], "}"}]}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"toSell", "=", 
             RowBox[{"ownedCommodities", "*", "currPrice"}]}], "}"}], ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"newMoney", "=", 
               RowBox[{"money", "+", "toSell"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"toSpend", "=", 
                 RowBox[{"newMoney", " ", "*", " ", 
                  RowBox[{"Sign", "[", "edge", "]"}], 
                  RowBox[{
                   RowBox[{"rectifier", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", "edge", "]"}], "-", "r"}], "]"}], "/", 
                   RowBox[{"stddev", "^", "2"}]}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newCommodities", "=", 
                    RowBox[{"toSpend", "/", "currPrice"}]}], ",", 
                   RowBox[{"left", "=", 
                    RowBox[{"newMoney", "-", "toSpend"}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"left", "<", "0"}], ",", " ", 
                    RowBox[{"(*", "borrow", "*)"}], 
                    RowBox[{"left", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}]}], ",", "left"}], "]"}], 
                   ",", " ", "newCommodities"}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}]}], "]"}], "\[IndentingNewLine]", "stateSparse"}], "=", 
        RowBox[{"FoldList", "[", 
         RowBox[{"makeInvestmentSparse", ",", 
          RowBox[{"{", 
           RowBox[{"invest", ",", " ", "0"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", "\"\<Returns\>\"", "]"}], ",", 
              RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "}"}], "&"}], "/@", 
           "joinedSparse"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pricesSparse", "=", 
       RowBox[{"pp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", 
         "joinedSparse"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"valueSparse", "=", 
       RowBox[{
        RowBox[{"First", "/@", "stateSparse"}], "+", 
        RowBox[{
         RowBox[{"stateSparse", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", "pricesSparse"}]}]}],
       ";", "\[IndentingNewLine]", 
      FractionBox[
       RowBox[{
        RowBox[{"Last", "@", "valueSparse"}], "-", "invest"}], "invest"]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "0.1", ",", "0.001"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.657807931712964*^9, 3.657808026232649*^9}, {
   3.657808148417593*^9, 3.6578081541821537`*^9}, {3.6578082495799932`*^9, 
   3.6578082623643293`*^9}, {3.657808312300622*^9, 3.657808316206072*^9}, {
   3.657808389862636*^9, 3.657808681573633*^9}, {3.6578087390986767`*^9, 
   3.6578087394459343`*^9}, {3.657809567548814*^9, 3.6578095677468157`*^9}, {
   3.6578096137914743`*^9, 3.6578096943951607`*^9}, {3.6578097377407703`*^9, 
   3.6578097379851923`*^9}, {3.657809880407792*^9, 3.657809995089163*^9}, {
   3.657810047500515*^9, 3.657810054980256*^9}, {3.6578101363090363`*^9, 
   3.657810156130596*^9}, {3.65781037064085*^9, 3.6578103972876043`*^9}, {
   3.657810493592802*^9, 3.6578106474712553`*^9}, {3.657810778311906*^9, 
   3.6578108246894007`*^9}, {3.657811010875854*^9, 3.657811013568528*^9}, {
   3.657811252818816*^9, 3.657811256871009*^9}, {3.6578112970066023`*^9, 
   3.6578112975432777`*^9}, {3.657811340273428*^9, 3.6578113426780787`*^9}, {
   3.65781137530328*^9, 3.65781137595359*^9}, {3.657811466354604*^9, 
   3.657811466618636*^9}, {3.657811538832245*^9, 3.65781155057051*^9}, {
   3.657811597415887*^9, 3.6578116068711767`*^9}, {3.657811788052796*^9, 
   3.657811794298174*^9}, {3.6578118445436563`*^9, 3.657811869307275*^9}, {
   3.657811910424323*^9, 3.65781214745044*^9}, {3.6578122420916367`*^9, 
   3.657812269483489*^9}, {3.6578123556835012`*^9, 3.657812359637806*^9}, {
   3.657812419022318*^9, 3.657812464261471*^9}, {3.657812574993153*^9, 
   3.657812585528028*^9}, {3.657812634706963*^9, 3.657812635373179*^9}, {
   3.657831661581546*^9, 3.657831667363652*^9}, {3.657832001279263*^9, 
   3.657832042730298*^9}, {3.657832074403233*^9, 3.657832129195593*^9}, {
   3.6578321928766727`*^9, 3.657832201098682*^9}, {3.657832260001725*^9, 
   3.6578322858955107`*^9}, {3.657832322798876*^9, 3.657832324184436*^9}, {
   3.657832373261435*^9, 3.657832391582864*^9}, {3.6578324416734943`*^9, 
   3.657832452886701*^9}, {3.657832538757846*^9, 3.6578325393573427`*^9}, {
   3.657832591124441*^9, 3.657832646698277*^9}, {3.6578327625669003`*^9, 
   3.657832762738205*^9}, {3.65783925976475*^9, 3.6578392948311872`*^9}, {
   3.65797141679919*^9, 3.657971455764757*^9}, {3.6579757636713123`*^9, 
   3.6579757746866417`*^9}, {3.6579758636452093`*^9, 3.657975892248171*^9}, {
   3.6579760647648773`*^9, 3.6579760669661627`*^9}, {3.657976265642148*^9, 
   3.657976272556223*^9}, {3.65797681013312*^9, 3.65797685089924*^9}, {
   3.657976968478087*^9, 3.657976971608127*^9}, {3.6579770066592407`*^9, 
   3.657977036476411*^9}, 3.657977106859095*^9, 3.657978102636469*^9, {
   3.6579782580160437`*^9, 3.6579783031145*^9}, {3.6579784467100887`*^9, 
   3.6579784498935137`*^9}, {3.65798082980105*^9, 3.657980963649066*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"valueSparse", "-", "invest"}], "invest"], "//", "Last"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.65798090975861*^9, 3.65798091237469*^9}, {
  3.657981183267538*^9, 3.6579812208572493`*^9}, {3.657981316966261*^9, 
  3.657981317360992*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.006570602186324`"}]], "Output",
 CellChangeTimes->{{3.65798091265449*^9, 3.657980966211926*^9}, {
   3.657981187833054*^9, 3.657981221189824*^9}, 3.657981318038055*^9, 
   3.661614842219595*^9, 3.661615653181501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pp", "@", "pricesSparse"}], ",", "valueSparse"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Trading Day\>\"", ",", " ", "\"\<Value ($)\>\""}], "}"}]}], 
   ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", "\"\<r=0 Trading performance vs. XAG\>\""}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "invest"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "valueSparse"}], "+", "1"}], ",", "invest"}],
         "}"}]}], "}"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6579757783076153`*^9, 3.6579758788822937`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1: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
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.007333333333333334], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1: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
0P3UxcNy1bBM28sUPx7SpsL/pLw/35/j9gJz
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Trading Day\"", TraditionalForm], 
    FormBox["\"Value ($)\"", TraditionalForm]},
  AxesOrigin->{0, 14.113195000000001`},
  DisplayFunction->Identity,
  Epilog->LineBox[{{-1, 15}, {223, 15}}],
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->600,
  Method->{},
  PlotLabel->FormBox["\"r=0 Trading performance vs. XAG\"", TraditionalForm],
  PlotRange->{{0., 223.}, {14.2814, 17.6455}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6579782674289503`*^9, 3.6579782804598427`*^9}, 
   3.657978510353355*^9, 3.661613636192202*^9, {3.661614824107547*^9, 
   3.661614842255679*^9}, 3.661615653216236*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Labeled", "[", 
  RowBox[{
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"TwoAxisListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pp", "@", "pricesSparse"}], ",", "valueSparse"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time\>\"", ",", "\"\<Silver Price\>\""}], 
               "}"}]}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time\>\"", ",", " ", "\"\<Net Value\>\""}], 
               "}"}]}]}], "}"}]}], "}"}]}], "]"}], ",", "\"\<Ag Price\>\"", 
       ",", " ", "Left"}], "]"}], ",", "\"\<Net Value\>\"", ",", " ", 
     "Right"}], "]"}], ",", "\"\<Time\>\"", ",", " ", "Bottom"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.656807638897766*^9, 3.6568076451392107`*^9}, {
  3.656809125796892*^9, 3.656809137882715*^9}, {3.656809229337903*^9, 
  3.656809269281384*^9}, {3.656809321288967*^9, 3.6568094630059023`*^9}, {
  3.656809621205243*^9, 3.6568097079679127`*^9}, {3.6568097724792137`*^9, 
  3.656809774772797*^9}, {3.657286912181917*^9, 3.6572869127733297`*^9}, {
  3.657287021900613*^9, 3.657287052401288*^9}, {3.657809588009139*^9, 
  3.657809590500804*^9}, {3.657812612744878*^9, 3.657812620617111*^9}, {
  3.657832287485591*^9, 3.657832314643202*^9}, {3.657971631905031*^9, 
  3.6579716792222652`*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{
     TemplateBox[{
       GraphicsBox[{{{}, {{{}, {}, {
             Hue[0.67, 0.6, 0.6], 
             Directive[
              PointSize[0.009166666666666668], 
              AbsoluteThickness[1.6], 
              RGBColor[0.24720000000000014`, 0.24, 0.6]], 
             LineBox[CompressedData["
1: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
              
              "]]}}}, {}}, 
         GeometricTransformationBox[{{}, {{{}, {}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[0.009166666666666668], 
               AbsoluteThickness[1.6], 
               RGBColor[0.6, 0.24, 0.4428931686004542]], 
              LineBox[CompressedData["
1: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
0P3UxcNy1bBM28sUPx7SpsL/pLw/35/j9gJz
               "]]}}}, {}}, {{{1., 0.}, {
           0., 17.00953387516471}}, {0., -237.77776349508684`}}]}, {
        Axes -> False, Frame -> True, FrameStyle -> {{
            RGBColor[0.24720000000000014`, 0.24, 0.6], 
            RGBColor[0.6, 0.24, 0.4428931686004542]}, {Automatic, Automatic}},
          FrameTicks -> {{{{14., 
              FormBox["14.`", TraditionalForm]}, {15., 
              FormBox["15.`", TraditionalForm]}, {16., 
              FormBox["16.`", TraditionalForm]}, {17., 
              FormBox["17.`", TraditionalForm]}, {18., 
              FormBox["18.`", TraditionalForm]}}, {{14., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"14.8\\\\\\\"\\\
\", 14.802155387850018`, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {15., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"14.86\\\\\\\"\\\
\", 14.860945946564863`, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {16., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"14.92\\\\\\\"\\\
\", 14.919736505279706`, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}, {17., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"14.98\\\\\\\"\\\
\", 14.97852706399455`, Rule[AutoDelete, True]], Function[NumberForm[Slot[1], \
4]]]\\)\"", TraditionalForm]}, {18., 
              FormBox[
              "\"\\!\\(\\*TagBox[InterpretationBox[\\\"\\\\\\\"15.04\\\\\\\"\\\
\", 15.037317622709395`, Rule[AutoDelete, True]], \
Function[NumberForm[Slot[1], 4]]]\\)\"", TraditionalForm]}}}, {
           Automatic, Automatic}}, DisplayFunction -> Identity, 
         PlotRangePadding -> {{
            Scaled[0.02], 
            Scaled[0.02]}, {
            Scaled[0.05], 
            Scaled[0.05]}}, AxesOrigin -> {0, 14.113195000000001`}, 
         PlotRange -> {{0., 223.}, {14.2814, 17.6455}}, DisplayFunction -> 
         Identity, AspectRatio -> 
         NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
         AxesLabel -> {
           FormBox["\"Time\"", TraditionalForm], 
           FormBox["\"Silver Price\"", TraditionalForm]}, 
         AxesOrigin -> {0, 14.113195000000001`}, DisplayFunction :> Identity, 
         Frame -> {{False, False}, {False, False}}, 
         FrameLabel -> {{None, None}, {None, None}}, 
         FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
         GridLines -> {None, None}, GridLinesStyle -> Directive[
           GrayLevel[0.5, 0.4]], ImageSize -> 600, Method -> {}, 
         PlotRange -> {{0., 223.}, {14.2814, 17.6455}}, PlotRangeClipping -> 
         True, PlotRangePadding -> {{
            Scaled[0.02], 
            Scaled[0.02]}, {
            Scaled[0.05], 
            Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
       "\"Ag Price\""}, "Labeled", DisplayFunction -> (GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ), 
      InterpretationFunction -> (RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )], "\"Net Value\""}, 
    "Labeled", DisplayFunction -> (GridBox[{{
        TagBox[
         ItemBox[
          PaneBox[
           TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
           BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
         "SkipImageSizeLevel"], 
        ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
      GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
      AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      BaselinePosition -> {1, 1}]& ), 
    InterpretationFunction -> (RowBox[{"Labeled", "[", 
       RowBox[{#, ",", #2, ",", "Right"}], "]"}]& )],"\"Time\""},
  "Labeled",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}, {
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, 
    GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
    BaselinePosition -> {1, 1}]& ),
  InterpretationFunction->(RowBox[{"Labeled", "[", 
     RowBox[{#, ",", #2, ",", "Bottom"}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.656809441358307*^9, 3.656809463542344*^9}, {
   3.656809581260227*^9, 3.656809637800096*^9}, 3.656809669060959*^9, {
   3.65680977536656*^9, 3.656809806265894*^9}, {3.656809867455833*^9, 
   3.6568098842184467`*^9}, 3.656810433922235*^9, {3.657286899111112*^9, 
   3.657286964218913*^9}, 3.657287022925918*^9, 3.657287053414268*^9, 
   3.657291637327311*^9, 3.657291698316473*^9, 3.65729174817239*^9, 
   3.6572961109198*^9, 3.657296145363182*^9, 3.65780959108847*^9, 
   3.6578096326581306`*^9, 3.657809697719513*^9, 3.657809739744092*^9, {
   3.657809987612183*^9, 3.657809996286491*^9}, 3.657810057291358*^9, 
   3.65781015746454*^9, 3.6578102158802013`*^9, 3.6578106321219063`*^9, 
   3.657810678766747*^9, 3.6578108442178383`*^9, 3.657811016106906*^9, {
   3.657811238353897*^9, 3.65781125993678*^9}, 3.657811308179744*^9, 
   3.6578113460126247`*^9, 3.657811379282545*^9, 3.657811467985429*^9, 
   3.657811610240883*^9, 3.6578120877440166`*^9, 3.6578121744699593`*^9, {
   3.657812440081521*^9, 3.657812467137145*^9}, {3.657812589742272*^9, 
   3.657812620792535*^9}, {3.657832273535677*^9, 3.657832392849553*^9}, 
   3.657832447160556*^9, 3.657833261010262*^9, {3.657833479247386*^9, 
   3.657833487702642*^9}, {3.657839038381048*^9, 3.657839049686905*^9}, {
   3.65783926907104*^9, 3.657839298666978*^9}, 3.6579010131428022`*^9, 
   3.6579082304268627`*^9, 3.6579714784441023`*^9, {3.657971657306079*^9, 
   3.6579716797123623`*^9}, {3.657974448639674*^9, 3.657974478079303*^9}, 
   3.657974596788568*^9, 3.657978510411748*^9, 3.661614842295089*^9, 
   3.661615653255776*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Two", " ", "axis", " ", "list", " ", "plot", " ", "adopted", " ", "from", 
    " ", "docs"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TwoAxisListPlot", "[", 
     RowBox[{"{", 
      RowBox[{"f_", ",", " ", "g_"}], "}"}], "]"}], ":=", 
    RowBox[{"TwoAxisListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", " ", "g"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TwoAxisListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f_", ",", "g_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "opts1___", "}"}], ",", " ", 
        RowBox[{"{", "opts2___", "}"}]}], "}"}], ",", " ", 
      RowBox[{"rTickAcc_Integer:", "4"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fgraph", ",", "ggraph", ",", "frange", ",", "grange", ",", "fticks", 
        ",", "gticks", ",", "fstyle", ",", " ", "gstyle"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "plot", " ", "style"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fstyle", " ", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "opts1", "}"}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"PlotStyle", "\[Rule]", "a_"}], ")"}], "\[RuleDelayed]", 
            "a"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gstyle", " ", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "opts2", "}"}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"PlotStyle", "\[Rule]", "a_"}], ")"}], "\[RuleDelayed]", 
            "a"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fgraph", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ColorData", "[", "1", "]"}], "[", "1", "]"}], ",", " ",
              "fstyle"}], "}"}]}], ",", " ", "opts1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ggraph", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ColorData", "[", "1", "]"}], "[", "2", "]"}], ",", " ",
              "gstyle"}], "}"}]}], ",", " ", "opts2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frange", ",", "grange"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"PlotRange", "/.", 
             RowBox[{"AbsoluteOptions", "[", 
              RowBox[{"#", ",", "PlotRange"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"fgraph", ",", "ggraph"}], "}"}]}]}], ";", 
       RowBox[{"fticks", "=", 
        RowBox[{"N", "@", 
         RowBox[{"FindDivisions", "[", 
          RowBox[{"frange", ",", "5"}], "]"}]}]}], ";", 
       RowBox[{"gticks", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"fticks", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"#", ",", "rTickAcc"}], "]"}], ",", 
                 "StandardForm"}], "]"}], "&"}], "/@", 
              RowBox[{"Rescale", "[", 
               RowBox[{"fticks", ",", "frange", ",", "grange"}], "]"}]}]}], 
            "}"}]}]}]}]}], ";", 
       RowBox[{"Show", "[", 
        RowBox[{"fgraph", ",", 
         RowBox[{"ggraph", "/.", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"graph_", ",", "s___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{"graph", ",", 
               RowBox[{"RescalingTransform", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "grange"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "frange"}], "}"}]}], 
                "]"}]}], "]"}], ",", "s"}], "]"}]}]}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "1", "]"}], "/@", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fticks", ",", "gticks"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
        "]"}]}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656809535131706*^9, 3.656809615736188*^9}, 
   3.657807682953431*^9, 3.657978685840479*^9}]
},
WindowSize->{1535, 876},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2680, 66, 143, "Input"],
Cell[3241, 88, 279, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[3545, 99, 198, 4, 32, "Input"],
Cell[3746, 105, 494, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4277, 119, 166, 3, 32, "Input"],
Cell[4446, 124, 550, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5033, 139, 261, 5, 32, "Input"],
Cell[5297, 146, 687, 12, 32, "Output"]
}, Open  ]],
Cell[5999, 161, 3108, 76, 191, "Input"],
Cell[9110, 239, 1919, 36, 55, "Input"],
Cell[CellGroupData[{
Cell[11054, 279, 181, 4, 32, "Input"],
Cell[11238, 285, 1272, 30, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12547, 320, 322, 9, 32, "Input"],
Cell[12872, 331, 404, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13313, 341, 216, 6, 32, "Input"],
Cell[13532, 349, 381, 6, 32, "Output"]
}, Open  ]],
Cell[13928, 358, 655, 15, 32, "Input"],
Cell[14586, 375, 639, 15, 55, "Input"],
Cell[CellGroupData[{
Cell[15250, 394, 294, 5, 55, "Input"],
Cell[15547, 401, 484, 7, 32, "Output"],
Cell[16034, 410, 485, 7, 32, "Output"]
}, Open  ]],
Cell[16534, 420, 261, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[16820, 431, 3510, 85, 209, "Input"],
Cell[20333, 518, 11886, 286, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32256, 809, 1882, 41, 99, "Input"],
Cell[34141, 852, 6187, 124, 368, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40365, 981, 148, 3, 32, "Input"],
Cell[40516, 986, 354, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40907, 998, 152, 3, 32, "Input"],
Cell[41062, 1003, 366, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41465, 1016, 126, 2, 32, "Input"],
Cell[41594, 1020, 349, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41980, 1032, 147, 3, 32, "Input"],
Cell[42130, 1037, 371, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42538, 1049, 312, 8, 32, "Input"],
Cell[42853, 1059, 238, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43128, 1068, 311, 8, 32, "Input"],
Cell[43442, 1078, 381, 6, 32, "Output"]
}, Open  ]],
Cell[43838, 1087, 4704, 101, 209, "Input"],
Cell[CellGroupData[{
Cell[48567, 1192, 186, 5, 56, "Input"],
Cell[48756, 1199, 393, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49186, 1211, 202, 5, 56, "Input"],
Cell[49391, 1218, 286, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49714, 1227, 1257, 35, 55, "Input"],
Cell[50974, 1264, 6800, 126, 435, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57811, 1395, 334, 9, 32, "Input"],
Cell[58148, 1406, 314, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58499, 1419, 330, 9, 32, "Input"],
Cell[58832, 1430, 289, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59158, 1443, 173, 3, 56, "Input"],
Cell[59334, 1448, 158, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59529, 1455, 403, 12, 32, "Input"],
Cell[59935, 1469, 186, 3, 32, "Output"]
}, Open  ]],
Cell[60136, 1475, 6593, 136, 330, "Input"],
Cell[CellGroupData[{
Cell[66754, 1615, 323, 8, 81, "Input"],
Cell[67080, 1625, 247, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67364, 1634, 936, 26, 55, "Input"],
Cell[68303, 1662, 6869, 125, 382, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75209, 1792, 1876, 42, 99, "Input"],
Cell[77088, 1836, 12816, 231, 392, "Output"]
}, Open  ]],
Cell[89919, 2070, 5948, 156, 297, "Input",
 InitializationCell->True]
}
]
*)

(* End of internal cache information *)
